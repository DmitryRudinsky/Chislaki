# Сравнительный анализ методов Лагранжа и Ньютона

## Теоретическое сравнение

| Характеристика | Метод Лагранжа | Метод Ньютона |
|----------------|----------------|---------------|
| **Форма** | Сумма базисных многочленов | Последовательность произведений |
| **Коэффициенты** | Зависят от всех узлов | Разделённые разности |
| **Добавление узлов** | Полный пересчёт | Добавление одного члена |
| **Оценка погрешности** | Сложная | Естественная (через разд. разности) |
| **Численная стабильность** | Средняя | Обычно выше |

## Проверка идентичности результатов

Для одинаковых наборов узлов оба метода должны давать **одинаковые** результаты, так как строят один и тот же интерполяционный многочлен.

### Тест 1: Интервал [-0.16, 0.62], степень 2

**Лагранж:**
```
P₂(0.413) = 4.137985
```

**Ньютон:**
```
P₂(0.413) = 4.137985
Разделённые разности: [4.0349, -0.2077, 2.1180]
```

✅ **Результаты совпадают!**

### Тест 2: Интервал [-0.16, 1.01], степень 3

**Лагранж:**
```
P₃(0.413) = 4.647006
```

**Ньютон:**
```
P₃(0.413) = 4.647006
Разделённые разности: [4.0349, -0.2077, 2.1180, -23.4509]
```

✅ **Результаты совпадают!**

### Тест 3: Интервал [0.23, 1.01], степень 2

**Лагранж:**
```
P₂(0.413) = 5.177347
```

**Ньютон:**
```
P₂(0.413) = 5.177347
Разделённые разности: [3.9539, 1.4444, -25.3195]
```

✅ **Результаты совпадают!**

## Полная таблица сравнения для всех интервалов

### Многочлен 2-й степени

| № | Интервал | Лагранж | Ньютон | Разница | Погрешность (Ньютон) |
|---|----------|---------|--------|---------|----------------------|
| 1 | [-1.33, -0.55] | 2.566938 | 2.566938 | 0.000000 | ≤ 1.98e+1 |
| 2 | [-0.94, -0.16] | 30.574986 | 30.574986 | 0.000000 | ≤ 2.94e+1 |
| 3 | [-0.55, 0.23] | 0.712901 | 0.712901 | 0.000000 | ≤ 5.14e+0 |
| 4 | [-0.16, 0.62] ✓ | 4.137985 | 4.137985 | 0.000000 | ≤ 7.66e-2 |
| 5 | [0.23, 1.01] ✓ | 5.177347 | 5.177347 | 0.000000 | ≤ 9.54e-1 |
| 6 | [0.62, 1.40] | 10.266104 | 10.266104 | 0.000000 | ≤ 3.72e+0 |
| 7 | [1.01, 1.79] | 5.182804 | 5.182804 | 0.000000 | ≤ 9.78e+0 |

### Многочлен 3-й степени

| № | Интервал | Лагранж | Ньютон | Разница | Погрешность (Ньютон) |
|---|----------|---------|--------|---------|----------------------|
| 1 | [-1.33, -0.16] | 44.291749 | 44.291749 | 0.000000 | ≤ 1.28e+1 |
| 2 | [-0.94, 0.23] | -3.957835 | -3.957835 | 0.000000 | ≤ 2.63e+0 |
| 3 | [-0.55, 0.62] ✓ | 3.532009 | 3.532009 | 0.000000 | ≤ 2.66e-1 |
| 4 | [-0.16, 1.01] ✓ | 4.647006 | 4.647006 | 0.000000 | ≤ 1.37e-1 |
| 5 | [0.23, 1.40] ✓ | 5.973281 | 5.973281 | 0.000000 | ≤ 3.27e-1 |
| 6 | [0.62, 1.79] | 11.165457 | 11.165457 | 0.000000 | ≤ 1.28e+0 |

## Ключевые выводы

### 1. Математическая эквивалентность

Оба метода строят **один и тот же интерполяционный многочлен**, только в разных формах:

- **Лагранж:** \( L_n(x) = \sum_{i=0}^{n} y_i \cdot l_i(x) \)
- **Ньютон:** \( N_n(x) = a_0 + a_1(x-x_0) + ... + a_n(x-x_0)...(x-x_{n-1}) \)

Но \( L_n(x) \equiv N_n(x) \) для одних и тех же узлов!

### 2. Преимущества метода Ньютона

✅ **Встроенная оценка погрешности** через разделённые разности

✅ **Эффективное добавление узлов** - не нужно пересчитывать всё

✅ **Лучшая численная стабильность** при большом числе узлов

✅ **Меньше операций** при последовательном добавлении точек

### 3. Преимущества метода Лагранжа

✅ **Симметричная форма** - все узлы равноправны

✅ **Проще для теоретического анализа**

✅ **Не требует определённого порядка узлов**

✅ **Более наглядная геометрическая интерпретация**

### 4. Анализ погрешностей

Для интервалов, содержащих x* = 0.413:

**Степень 2:**
- Минимальная погрешность: ≤ 0.077 (интервал 4)
- Максимальная погрешность: ≤ 0.954 (интервал 5)

**Степень 3:**
- Минимальная погрешность: ≤ 0.137 (интервал 4)
- Максимальная погрешность: ≤ 0.327 (интервал 5)

**Наблюдение:** Степень 3 даёт более стабильные погрешности для интервалов с x*.

### 5. Влияние экстраполяции

Для интервалов, НЕ содержащих x*:

- **P₂:** погрешность до 29.39 (в **383 раза** больше!)
- **P₃:** погрешность до 12.81 (в **94 раза** больше!)

**Критический вывод:** 
> Экстраполяция интерполяционными многочленами крайне ненадёжна!

## Практические рекомендации

1. **Для однократной интерполяции** - используйте метод Лагранжа (проще)

2. **Для добавления узлов** - используйте метод Ньютона (эффективнее)

3. **Для оценки погрешности** - метод Ньютона предпочтительнее

4. **Всегда проверяйте** - находится ли точка интерполяции внутри интервала узлов

5. **Избегайте экстраполяции** - погрешность растёт катастрофически

6. **Сравнивайте результаты** на разных интервалах для оценки надёжности

## Вычислительная сложность

### Однократная интерполяция в одной точке

- **Лагранж:** O(n²) операций
- **Ньютон:** O(n²) для построения таблицы + O(n) для вычисления

### Добавление k новых узлов

- **Лагранж:** O((n+k)²) - полный пересчёт
- **Ньютон:** O(n·k) - только новые разделённые разности

**При k > √n метод Ньютона значительно эффективнее!**

## Заключение

Оба метода являются мощными инструментами интерполяции:

- **Метод Лагранжа** - элегантен и прост для понимания
- **Метод Ньютона** - практичен и эффективен для вычислений

Выбор метода зависит от конкретной задачи, но **оба дают идентичные результаты** при одинаковых узлах, что подтверждает корректность реализации!

